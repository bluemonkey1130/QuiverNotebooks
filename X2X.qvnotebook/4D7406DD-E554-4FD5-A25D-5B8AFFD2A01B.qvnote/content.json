{
  "title": "Iframe scraper",
  "cells": [
    {
      "type": "code",
      "language": "javascript",
      "data": " function iframeFunction (){ \n                let loaderWrapperEl = document.getElementById('loader-container');\n                let loaderEl = document.getElementsByClassName('loader-wrapper');\n                let el = document.getElementById('article-marker');\n                \n                $(el).empty(); // empty container\n                $(loaderWrapperEl).fadeIn(); // show loader wrapper\n                $(loaderEl).fadeIn(); // show loader\n                gsap.to(window, {duration: 1.2,  ease: \"power4.inOut\", scrollTo: {y:loaderWrapperEl, offsetY: 80}}) // scroll loader into view\n                let ifrm = document.createElement('iframe'); // create iframe\n                ifrm.style.display = 'none'; // hide iframe\n                ifrm.setAttribute('src', 'https://' + this.dataset.iframe); // set src\n                $(el).siblings('iframe').remove(); // remove previous iframes\n                el.parentNode.insertBefore(ifrm, el); // insert into dom to start loading\n                \n                ifrm.onload = function() {  // on load\n                    $(loaderEl).fadeOut(); // hide the loader\n                    let content = ifrm.contentWindow.document.getElementsByClassName('text-wrapper'); // target in Updated Template\n                    if(content.length > 0){\n                        let contentLinks = ifrm.contentWindow.document.getElementById('link-wrap');\n                        el.innerHTML = content[0].innerHTML;\n                        let cmsVid = $('.cms-video');\n                        cmsVid.empty();\n                        let newVid = '<div id=\"proxy-player\" data-plyr-provider=\"vimeo\" data-plyr-embed-id=\"'+cmsVid[0].dataset.id+'\"></div>'\n                        $(cmsVid).append(newVid);\n                        inlineVideo();\n                        $(el).append(contentLinks);\n                    }else{\n                        let content = ifrm.contentWindow.document.getElementsByClassName('main'); // target in  Previous Template \n                        el.innerHTML = content[0].innerHTML;\n                        let cmsVid = $('.video');\n                        let iframe = cmsVid.children('iframe');\n                        let url = iframe[0].src;\n                        var match = /vimeo.*\\/(\\d+)/i.exec( url );\n                        if (match){\n                            cmsVid.empty();\n                            let newVid = '<div id=\"proxy-player\" data-plyr-provider=\"vimeo\" data-plyr-embed-id=\"'+match[1]+'\"></div>'\n                            $(cmsVid).append(newVid);\n                            inlineVideo();\n                        }\n                        \n                    }\n                    \n                    \n                    var y = $(window).scrollTop();  //your current y position on the page\n                    $(window).scrollTop(y+1);\n                    ScrollTrigger.refresh();\n                };\n                function inlineVideo() {\n                    const controls = `\n                    <div class=\"plyr__controls\">\n                       <button type=\"button\" class=\"plyr__control\" data-plyr=\"fullscreen\">\n                          <svg class=\"icon--pressed\" role=\"presentation\"><use xlink:href=\"#plyr-exit-fullscreen\"></use></svg>\n                          <svg class=\"icon--not-pressed\" role=\"presentation\"><use xlink:href=\"#plyr-enter-fullscreen\"></use></svg>\n                          <span class=\"label--pressed plyr__tooltip\" role=\"tooltip\">Exit fullscreen</span>\n                          <span class=\"label--not-pressed plyr__tooltip\" role=\"tooltip\">Enter fullscreen</span>\n                      </button>\n                      <button id=\"playButton\" type=\"button\" class=\"plyr__control\" aria-label=\"Play, {title}\" data-plyr=\"play\">\n                          <svg class=\"icon--pressed\" role=\"presentation\"><use xlink:href=\"#plyr-pause\"></use></svg>\n                          <svg class=\"icon--not-pressed\" role=\"presentation\"><use xlink:href=\"#plyr-play\"></use></svg>\n                          <span class=\"label--pressed plyr__tooltip\" role=\"tooltip\">Pause</span>\n                          <span class=\"label--not-pressed plyr__tooltip\" role=\"tooltip\">Play</span>\n                      </button>\n                      <button type=\"button\" class=\"plyr__control\" aria-label=\"Mute\" data-plyr=\"mute\">\n                          <svg class=\"icon--pressed\" role=\"presentation\"><use xlink:href=\"#plyr-muted\"></use></svg>\n                          <svg class=\"icon--not-pressed\" role=\"presentation\"><use xlink:href=\"#plyr-volume\"></use></svg>\n                          <span class=\"label--pressed plyr__tooltip\" role=\"tooltip\">Unmute</span>\n                          <span class=\"label--not-pressed plyr__tooltip\" role=\"tooltip\">Mute</span>\n                      </button>\n                      <div class=\"plyr__progress\">\n                          <input data-plyr=\"seek\" type=\"range\" min=\"0\" max=\"100\" step=\"0.01\" value=\"0\" aria-label=\"Seek\">\n                          <progress class=\"plyr__progress__buffer\" min=\"0\" max=\"100\" value=\"0\">% buffered</progress>\n                          <span role=\"tooltip\" class=\"plyr__tooltip\">00:00</span>\n                      </div>\n                      <div class=\"plyr__time plyr__time--current\" aria-label=\"Current time\">00:00</div>\n                    </div>\n                    `;\n                    const players = Array.from(document.querySelectorAll('#proxy-player')).map(p => new Plyr(p,{\n                        controls: controls,\n                        invertTime: true,\n                        hideControls: false,\n                        disableContextMenu: true\n                    }));\n                }\n            }"
    }
  ]
}